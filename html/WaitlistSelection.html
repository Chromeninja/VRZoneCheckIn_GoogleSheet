<!-- File Name: WaitlistSelection.html -->
<!DOCTYPE html>
<html>
  <body>
    <p><strong>Note:</strong> The format is "Name - Game".</p>
    <form id="waitlistForm">
      <label for="waitlistSelect"><?= title ?></label>
      <select id="waitlistSelect">
        <? if (waitlistEntries.length > 0) { ?>
          <? for (var i = 0; i < waitlistEntries.length; i++) { ?>
            <option value="<?= waitlistEntries[i].sessionId ?>">
              <?= waitlistEntries[i].firstName ?> - <?= waitlistEntries[i].game ?>
            </option>
          <? } ?>
        <? } else { ?>
          <option value="">No attendees on the waitlist</option>
        <? } ?>
      </select><br><br>
      <input type="submit" value="<?= buttonLabel ?>">
    </form>

    <script>
      function handleFormSubmit(formId, selectId, callbackFunction) {
        const form = document.getElementById(formId);
        form.addEventListener('submit', function(event) {
          event.preventDefault();
          const selectedValue = document.getElementById(selectId).value;

          google.script.run.withSuccessHandler(function() {
            google.script.host.close();
          })[callbackFunction](selectedValue);
        });
      }

      // Initialize the form submission process
      handleFormSubmit('waitlistForm', 'waitlistSelect', 'processMoveFromWaitlist');
    </script>
  </body>
</html>
